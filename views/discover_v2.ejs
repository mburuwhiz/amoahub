<link rel="stylesheet" href="/css/discover.css">

<div class="discover-page-wrapper">
    <div class="discover-container-v3">
        <!-- Recently Viewed Section -->
        <div class="discover-section">
            <h2>Recently Viewed</h2>
            <div class="recently-viewed-container">
                <button class="scroll-arrow left" id="scroll-left">&lt;</button>
                <div class="recently-viewed-scroller" id="recently-viewed-scroller">
                    <% if (recentlyViewed && recentlyViewed.length > 0) { %>
                        <% recentlyViewed.forEach(user => { %>
                            <a href="/users/<%= user._id %>" class="discover-card">
                                <div class="discover-card-img-wrapper">
                                    <img src="<%= (user.profileImage && user.profileImage.url) ? user.profileImage.url : '/img/default-avatar.png' %>" alt="<%= user.displayName %>" class="discover-card-img">
                                </div>
                                <h4 class="discover-card-name"><%= user.displayName %></h4>
                                <p class="discover-card-subtext">Last viewed</p>
                            </a>
                        <% }) %>
                    <% } else { %>
                        <p>No recently viewed profiles.</p>
                    <% } %>
                </div>
                <button class="scroll-arrow right" id="scroll-right">&gt;</button>
            </div>
        </div>

        <!-- All People Section -->
        <div class="discover-section">
            <h2>All People</h2>
            <div class="all-people-grid">
                <% if (allPeople && allPeople.length > 0) { %>
                    <% allPeople.forEach(user => { %>
                         <a href="/users/<%= user._id %>" class="discover-card">
                            <div class="discover-card-img-wrapper">
                                <img src="<%= (user.profileImage && user.profileImage.url) ? user.profileImage.url : '/img/default-avatar.png' %>" alt="<%= user.displayName %>" class="discover-card-img">
                            </div>
                            <h4 class="discover-card-name"><%= user.displayName %></h4>
                            <p class="discover-card-subtext">View Profile</p>
                        </a>
                    <% }) %>
                <% } else { %>
                    <p>No one new to see right now.</p>
                <% } %>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const scroller = document.getElementById('recently-viewed-scroller');
    const scrollLeftBtn = document.getElementById('scroll-left');
    const scrollRightBtn = document.getElementById('scroll-right');

    if (scroller) {
        scrollLeftBtn.addEventListener('click', () => {
            scroller.scrollBy({ left: -200, behavior: 'smooth' });
        });

        scrollRightBtn.addEventListener('click', () => {
            scroller.scrollBy({ left: 200, behavior: 'smooth' });
        });
    }
});
</script>