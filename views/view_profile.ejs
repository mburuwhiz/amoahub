<div class="profile-page-container">
    <div class="profile-page-header" style="background-image: url('<%= profile.profileImage || '/img/default-avatar.png' %>');">
        <div class="profile-header-content">
            <img src="<%= profile.profileImage || '/img/default-avatar.png' %>" alt="Profile picture of <%= profile.displayName %>" class="profile-page-avatar">
            <h1 class="profile-page-name">
                <%= profile.displayName %>
                <% if (profile.isVerified) { %>
                    <img src="/img/verified-badge.svg" alt="Verified" class="verified-badge">
                <% } %>
                <span>(<%= profile.age %>)</span>
            </h1>
            <p class="profile-page-location"><%= profile.location %></p>
            <!-- Actions like 'Like' or 'Message' could go here in the future -->
        </div>
    </div>

    <div class="profile-page-body">
        <div class="profile-main-col">
            <div class="profile-widget">
                <h3>About <%= profile.displayName.split(' ')[0] %></h3>
                <p><%= profile.bio %></p>
            </div>
             <div class="profile-widget">
                <h3>Gallery</h3>
                <div class="gallery-grid">
                    <% if (profile.galleryImages && profile.galleryImages.length > 0) { %>
                        <% profile.galleryImages.forEach(img => { %>
                            <div class="gallery-item" style="background-image: url('<%= img %>');" data-full-image="<%= img %>" role="button" aria-label="View image larger"></div>
                        <% }) %>
                    <% } else { %>
                        <p>No gallery images to show.</p>
                    <% } %>
                </div>
            </div>
        </div>
        <div class="profile-sidebar-col">
            <div class="profile-widget">
                <h3>Details</h3>
                <ul class="details-list">
                    <li><strong>Work:</strong> <span><%= profile.work %></span></li>
                    <li><strong>Gender:</strong> <span><%= profile.gender %></span></li>
                     <li><strong>Phone:</strong> <span><%= profile.phoneNumber %></span></li>
                </ul>
            </div>
            <div class="profile-widget">
                <h3>Interests</h3>
                <div class="interests-tags">
                     <% if (profile.interests && profile.interests.length > 0) { %>
                        <% profile.interests.forEach(interest => { %>
                            <span class="interest-tag"><%= interest %></span>
                        <% }) %>
                    <% } else { %>
                        <p>No interests listed.</p>
                    <% } %>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Image Modal -->
<div id="image-modal" class="image-modal">
    <span class="close-modal">&times;</span>
    <img class="modal-content" id="modal-image">
</div>


<style>
/* Using existing profile styles from profile.ejs, just adding modal and gallery item cursor */
.profile-page-container { max-width: 1000px; margin: 1rem auto; background: #fff; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); overflow: hidden; }
.profile-page-header { height: 350px; background-size: cover; background-position: center; position: relative; }
.profile-page-header::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(10px); }
.profile-header-content { position: relative; z-index: 2; color: #fff; text-align: center; padding: 40px 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; }
.profile-page-avatar { width: 140px; height: 140px; border-radius: 50%; object-fit: cover; border: 4px solid #fff; box-shadow: 0 4px 15px rgba(0,0,0,0.2); margin-bottom: 1rem; }
.profile-page-name { font-size: 2rem; margin: 0; }
.profile-page-name span { font-weight: 400; }
.verified-badge { width: 24px; height: 24px; vertical-align: middle; margin-left: 5px; }
.profile-page-location { font-size: 1.1rem; margin: 0.25rem 0 1rem 0; opacity: 0.9; }
.profile-page-body { display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem; padding: 1.5rem; }
.profile-widget { background: #fff; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color); margin-bottom: 1.5rem; }
.profile-widget h3 { margin-top: 0; border-bottom: 1px solid var(--border-color); padding-bottom: 0.75rem; margin-bottom: 1rem; }
.details-list { list-style: none; padding: 0; margin: 0; }
.details-list li { display: flex; justify-content: space-between; padding: 0.5rem 0; }
.details-list li span { color: #555; }
.interests-tags { display: flex; flex-wrap: wrap; gap: 0.5rem; }
.interest-tag { background: var(--bg-light); padding: 0.3rem 0.8rem; border-radius: 50px; font-size: 0.9rem; border: 1px solid var(--border-color); }
.gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 1rem; }
.gallery-item { width: 100%; padding-bottom: 100%; background-size: cover; background-position: center; border-radius: 8px; cursor: pointer; transition: transform 0.2s ease; }
.gallery-item:hover { transform: scale(1.05); }

/* Image Modal Styles */
.image-modal { display: none; position: fixed; z-index: 1000; padding-top: 50px; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.9); }
.modal-content { margin: auto; display: block; width: 80%; max-width: 700px; }
.close-modal { position: absolute; top: 15px; right: 35px; color: #f1f1f1; font-size: 40px; font-weight: bold; transition: 0.3s; }
.close-modal:hover, .close-modal:focus { color: #bbb; text-decoration: none; cursor: pointer; }

@media (max-width: 768px) { .profile-page-body { grid-template-columns: 1fr; } .modal-content { width: 95%; } }
</style>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const modal = document.getElementById('image-modal');
        const modalImg = document.getElementById('modal-image');
        const galleryItems = document.querySelectorAll('.gallery-item');
        const closeModal = document.querySelector('.close-modal');

        galleryItems.forEach(item => {
            item.addEventListener('click', () => {
                modal.style.display = 'block';
                modalImg.src = item.dataset.fullImage;
            });
        });

        const close = () => {
            modal.style.display = 'none';
        }

        closeModal.addEventListener('click', close);
        modal.addEventListener('click', (e) => {
            // Close modal if the background (the modal itself) is clicked
            if (e.target === modal) {
                close();
            }
        });
    });
</script>